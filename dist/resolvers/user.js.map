{"version":3,"sources":["../../src/resolvers/user.js"],"names":["Query","user","_","_id","role","permission","isAuthenticated","User","findById","exec","users","args","isAdmin","find","sort","Mutation","loginUser","email","password","auth","login","createUser","input","userDB","save","deleteUser","findByIdAndDelete","updateUser","findByIdAndUpdate","movements","Movement"],"mappings":"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","sourcesContent":["import auth from '../middlewares/auth'\r\nimport User from '../models/user'\r\nimport Movement from '../models/movement'\r\nimport Inventory from '../models/inventory'\r\nimport permission from '../middlewares/permissions';\r\n\r\nexport default {\r\n    Query: {\r\n        user: async(_, { _id }, { user, role }) => {\r\n            permission.isAuthenticated(user)\r\n            return await User.findById(_id).exec()\r\n        },\r\n        users: async(_, args, { user, role }) => {\r\n            permission.isAdmin(user, role)\r\n            return await User.find().sort({_id: -1})\r\n        }\r\n    },\r\n    Mutation: {\r\n        loginUser: async (_, { email, password }) => auth.login(email, password),\r\n        createUser: async(_, { input }, { user, role }) => {\r\n            permission.isAdmin(user, role)\r\n            const userDB = new User(input)\r\n            return await userDB.save()\r\n        },\r\n        deleteUser: async(_, { _id }, { user, role }) => {\r\n            permission.isAuthenticated(user)\r\n            return await User.findByIdAndDelete(_id)\r\n        },\r\n        updateUser: async(_, { _id, input }, { user, role }) => {\r\n            permission.isAuthenticated(user)\r\n            return await User.findByIdAndUpdate(_id, input, { new: true })\r\n        }\r\n    },\r\n    User: {\r\n        movements: async({ _id }) => {\r\n            return await Movement.find({ user: _id })\r\n        },\r\n        // TODO: esto no esta funcoinando por ahora\r\n        // inventory: async({ inventory }) => {\r\n        //     return await Inventory.findById({ _id: inventory })\r\n        // }\r\n    }\r\n}"],"file":"user.js"}