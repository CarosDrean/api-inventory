{"version":3,"sources":["../../src/middlewares/permissions.js"],"names":["permission","isAuthenticated","user","Error","isAdmin","role","isUser","console","log","getRoleUser","_id","User","findOne"],"mappings":";;;;;;;AACA;;;;;;;;AADA,IAAMA,UAAU,GAAG,EAAnB;;AAGAA,UAAU,CAACC,eAAX,GAA6B,UAACC,IAAD,EAAU;AACnC,MAAG,CAACA,IAAJ,EAAU,MAAM,IAAIC,KAAJ,CAAU,gBAAV,CAAN;AACb,CAFD;;AAIAH,UAAU,CAACI,OAAX,GAAqB,UAACF,IAAD,EAAOG,IAAP,EAAgB;AACjCL,EAAAA,UAAU,CAACC,eAAX,CAA2BC,IAA3B;AACA,MAAGG,IAAI,KAAK,OAAZ,EAAqB,MAAM,IAAIF,KAAJ,CAAU,sBAAV,CAAN;AACxB,CAHD;;AAKAH,UAAU,CAACM,MAAX,GAAoB,UAACJ,IAAD,EAAOG,IAAP,EAAgB;AAChCL,EAAAA,UAAU,CAACC,eAAX,CAA2BC,IAA3B;AACAK,EAAAA,OAAO,CAACC,GAAR,CAAY,UAAUH,IAAtB;AACA,MAAGA,IAAI,KAAK,MAAZ,EAAoB,MAAM,IAAIF,KAAJ,CAAU,gBAAV,CAAN;AACvB,CAJD;;AAMAH,UAAU,CAACS,WAAX;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAyB,iBAAOC,GAAP;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACAC,iBAAKC,OAAL,CAAa;AAAEF,cAAAA,GAAG,EAAHA;AAAF,aAAb,EAAsB;AAACL,cAAAA,IAAI,EAAE;AAAP,aAAtB,CADA;;AAAA;AAAA;AACdA,YAAAA,IADc,SACdA,IADc;AAAA,6CAEdA,IAFc;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAzB;;AAAA;AAAA;AAAA;AAAA;;eAKeL,U","sourcesContent":["const permission = {}\r\nimport User from '../models/user'\r\n\r\npermission.isAuthenticated = (user) => {\r\n    if(!user) throw new Error('No autenticado')\r\n}\r\n\r\npermission.isAdmin = (user, role) => {\r\n    permission.isAuthenticated(user)\r\n    if(role !== 'Admin') throw new Error('No es administrador.')\r\n}\r\n\r\npermission.isUser = (user, role) => {\r\n    permission.isAuthenticated(user)\r\n    console.log('per: ' + role)\r\n    if(role !== 'User') throw new Error('No es usuario.')\r\n}\r\n\r\npermission.getRoleUser = async (_id) => {\r\n    const {role} = await User.findOne({ _id }, {role: 1})\r\n    return role\r\n}\r\n\r\nexport default permission"],"file":"permissions.js"}